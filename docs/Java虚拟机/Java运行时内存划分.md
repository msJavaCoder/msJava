# 👉 JVM的内存区域

​	**线程私有区域**的生命周期与线程相同，随线程的启动而创建，随线程的启动而创建，随线程的结束而销毁。在JVM内部，每个线程都与操作系统的本地线程直接映射，因此线程私有内存区域的存在与否和本地线程的启动和销毁对应。

​	**线程共享区域**随虚拟机的启动而创建，随虚拟机的关闭而销毁。

##  程序计数器 ： 线程私有，无内存溢出问题

​		程序计数器是一块很小的内存空间，用于存储当前运行的线程所执行的字节码的行号指令，每个运行中的线程都有一个独立的程序计数器，在方法正在执行时，该方法的程序计数器记录的是实时虚拟机字节码指令的地址；如果该方法执行的是Native方法，则程序计数器的值为空。

​		程序计数器是唯一没有内存溢出的区域。

## 虚拟机栈 ： 线程私有，描述Java方法的执行过程

​		虚拟机栈是描述Java方法的执行过程的内存模型，它在当前栈帧存储了局部变量表、操作数栈、动态链接、方法出口等信息。同时，栈帧用来存储部分运行时数据及其数据结构，处理动态链接方法的返回值和异常分派。

​		栈帧用来记录方法的执行过程，在方法被执行时虚拟机会为其创建一个与之对应的栈帧，方法的执行和返回对应栈帧在虚拟机中的入栈和出栈。无法方法是正常运行完成还是异常完成，都可以视为方法运行结束。

## 本地方法区 ： 线程私有

​		本地方法区和虚拟机栈作用类似，区别就是本地方法栈是为Native方法服务，而虚拟机栈是为了Java方法服务。

## 堆内存 ： 线程共享，运行时数据区

​		在JVM运行过程中创建的对象和产生的数据都被存储在堆中，堆是被线程共享的内存区域，也是垃圾收集器进行垃圾回首的最主要的内存区域。

## 方法区 ：线程共享

​		方法区用于存储常量、静态变量、类信息、即时编译器编译后的机器码、运行时常量池等数据。

​		JVM把GC分代收集扩展至方法区，即使用Java堆的永久代来实现方法区，这样JVM的垃圾收集器就可以像管理Java堆一样管理这部分内存。永久带的内存回收主要针对常量池的回收和类的卸载，因此可回收的对象很少。

​		常量被存储在运行时常量池中，是方法区的一部分。静态也属于方法区的一部分。在类信息中不但保存了类的版本/字段/方法/接口等描述信息，还保存了常量信息。

​		在即使编译后，代码的内容将在执行阶段被保存在方法区的运行时常量池中。Java虚拟机堆Class文件每一部分的格式都明确的规定，只有符合规范的Class文件才能通过虚拟机的检查，然后被装载和执行。

